What do you know about singletons? Where would you use one and where would you not?
===================================================================================

- 싱글톤 클래스는 몇 번을 요청해도 항상 동일한 객체를 반환합니다. 즉 싱글톤 객체란 애플리케이션 전반에 걸쳐 단 하나만 존재하는 클래스의 인스턴스를 말합니다. 코코아 프레임워크에서는 싱글톤을 매우 중요하게 생각하는데요. 우선 우리가 프로젝트 생성 후 가장 먼저 만나게되는 UIApplication 자체가 애플리케이션에 단 하나만 존재하는 싱글톤 객체이죠 소오~름.(그 외에 NotificationCenter.default, UserDefaults.standard, FileManager.default 등이 있습니다.)

- 현재 애플에서 지원을 중단한 듯한 "Cocoa Fundermental Guides" 에서는 싱글톤 객체를 반환하는 팩토리 메서드의 명명법은 "shared" + ClassType 라고 합니다만... swift 의 API 를 확인해보면 UIApplication 같은 경우에는 UIApplication.shared 라고 class computed var 로 선언되어 있습니다. 

- 싱글톤은 간단하게 구현(Objective-C 보다 훨씬 더 간결하게 구현할 수 있게 되었습니다.)해서 쉽게 사용할 수 있지만 anti-pattern 이라는 비난을 받기도 하죠. 그 이유는 단 하나의 객체를 이곳 저곳에서 직접적으로 접근하여 사용하다보니 특정 값에 변동이 생긴다면 예상하지 못한 버그가 발생할 수도 있고, 그로 인해 의도치 않게 해당 값 또는 상태에 의존하게 되기 때문입니다. 그렇기 때문에 애플은 싱글톤 객체를 일종의 컨트롤 센터로 만들어서 싱글톤 클래스의 서비스를 관리하도록 구현하였습니다.

- 아래는 간단한 싱글톤의 예입니다.

``` swift
class MySingleton {
	static let shared = MySingleton()
	var routeOfViews = [String]()
	private init() {}
}

// 각 화면에 진입할 때 마다 routeOfViews 에 화면 이름을 저장합니다.
MySingleton.shared.routeOfViews.append(String(describing: self).components(separatedBy: ".").last!)
```

- swift 는 static 변수 호출시 lazy 하게 초기화합니다. 즉 호출하는 시점에 초기화가 진행되어 해당 객체를 생성한 후 반환해준다는 거지요.(메모리 관리의 압박이 있는 iOS 를 위한 내부적인 메모리 최적화 방침이 아닐까요? ㅎㅎㅎ). 그리고 thread safe 하게 dispatch_once 로 동작합니다. 거의 집사 수준으로 개발자 편의를 위해 봉사하고 있습니다.

- 하지만 이러한 편리함 때문에 정말 필요에 의한 사용이 아닌 마치 뭐든 추가할 수 있는 전역 창고따위로 생각할 수도 있습니다. 불필요한 의존성이 단순히 개발 편의를 위해 주입된다는건 좀 아니죠...

- 또 이런 특성때문에 점점 사용 범위가 넓어지고, 결국 어디에서 사용되는지 추적하는 것이 힘들어질 지경에 이르기도 하죠. 만약 해당 싱글턴을 제거해야 한다면? ㅡ,.ㅡ;;;;

- 싱글톤이 다른 싱글톤을 참조하고 있는 경우, 참조 당하는 싱글톤의 기능이 수정되면 참조하는 싱글톤에 문제가 생길 수 있고, 결국 프로젝트 전반에 걸쳐 문제가 발생할 수 있습니다.


[Singleton is good 관련 참고 영상 링크](https://cocoacasts.com/what-is-a-singleton-and-how-to-create-one-in-swift/)

[Singleton is bad 관련 참고 영상 링크](https://cocoacasts.com/are-singletons-bad/)

[전역 상수 사용시 lazy 처리에 대한 링크](https://outofbedlam.github.io/swift/2016/03/04/Lazy/)

[@noescape 에 대해 잘 설명된 링크](https://krakendev.io/blog/hipster-swift)








